---
import { siteConfig } from "@/config/site";

const navLinks = siteConfig.navLinks;
---

<header
    id="main-header"
    class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 border-b border-black/10 bg-white/90 backdrop-blur-md"
>
    <div
        class="w-full flex justify-between items-stretch h-16 md:h-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 border-x border-black/10"
    >
        {/* Logo Section */}
        <div class="flex items-center pr-6 md:pr-8 border-r border-black/10">
            <a href="/" class="flex items-center gap-2">
                <img
                    src="/images/logo.png"
                    alt={siteConfig.name}
                    class="h-8 w-auto object-contain"
                />
            </a>
        </div>

        {/* Desktop Nav */}
        <nav class="hidden md:flex items-stretch ml-auto">
            {
                navLinks.map((link) => (
                    <a
                        href={link.href}
                        class="flex items-center px-8 border-l border-black/10 text-sm font-medium uppercase tracking-wide hover:bg-black hover:text-white transition-colors duration-200 group relative overflow-hidden"
                    >
                        <span class="relative z-10">{link.name}</span>
                    </a>
                ))
            }
            <a
                href="#contact"
                class="flex items-center px-8 border-l border-black/10 bg-black text-white text-sm font-medium uppercase tracking-wide hover:bg-gray-100 hover:text-black transition-colors duration-300"
            >
                Let's Talk
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="ml-2 w-4 h-4"
                    ><line x1="7" y1="17" x2="17" y2="7"></line><polyline
                        points="7 7 17 7 17 17"></polyline></svg
                >
            </a>
        </nav>

        {/* Mobile Menu Button */}
        <button
            id="mobile-menu-open"
            class="md:hidden flex items-center justify-center px-6 border-l border-black/10 ml-auto"
            aria-label="Open Menu"
            aria-expanded="false"
            aria-controls="mobile-menu-overlay"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="w-6 h-6"
                ><line x1="4" x2="20" y1="12" y2="12"></line><line
                    x1="4"
                    x2="20"
                    y1="6"
                    y2="6"></line><line x1="4" x2="20" y1="18" y2="18"
                ></line></svg
            >
        </button>
    </div>
</header>

{/* Mobile Menu Overlay */}
<div
    id="mobile-menu-overlay"
    class="fixed inset-0 z-[60] bg-white flex flex-col translate-y-[-100%] transition-transform duration-500 ease-[cubic-bezier(0.19,1,0.22,1)]"
    aria-hidden="true"
    role="dialog"
    aria-modal="true"
    aria-labelledby="mobile-menu-title"
    inert
>
    <div class="flex justify-between items-center p-6 border-b border-black/10">
        <span id="mobile-menu-title" class="font-display font-bold text-2xl uppercase">Menu</span>
        <button id="mobile-menu-close" aria-label="Close Menu">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="w-8 h-8"
                ><line x1="18" y1="6" x2="6" y2="18"></line><line
                    x1="6"
                    y1="6"
                    x2="18"
                    y2="18"></line></svg
            >
        </button>
    </div>
    <div class="flex flex-col p-6 space-y-6">
        {
            navLinks.map((link) => (
                <a
                    href={link.href}
                    class="mobile-nav-link font-display text-4xl md:text-6xl font-light uppercase hover:text-gray-500 transition-colors"
                >
                    {link.name}
                </a>
            ))
        }
        <a
            href="#contact"
            class="mobile-nav-link mt-8 inline-flex items-center justify-between w-full py-4 border-t border-b border-black font-display text-xl uppercase font-bold"
        >
            Let's Talk
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="w-6 h-6"
                ><line x1="7" y1="17" x2="17" y2="7"></line><polyline
                    points="7 7 17 7 17 17"></polyline></svg
            >
        </a>
    </div>
</div>

<script lang="ts">
    const header = document.getElementById("main-header");
    const mobileMenuOpen = document.getElementById("mobile-menu-open");
    const mobileMenuClose = document.getElementById("mobile-menu-close");
    const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
    const mobileNavLinks = document.querySelectorAll(".mobile-nav-link");

    // Scroll Logic
    window.addEventListener("scroll", () => {
        if (window.scrollY > 50) {
            header?.classList.add("shadow-sm");
            // Logic for isScrolled ? "py-0" : "py-0" was in React but practically no difference?
            // keeping it for consistency if needed later
        } else {
            header?.classList.remove("shadow-sm");
        }
    });

    // Mobile Menu Toggle
    function openMenu() {
        mobileMenuOverlay?.classList.remove("translate-y-[-100%]");
        mobileMenuOverlay?.classList.add("translate-y-0");
        mobileMenuOpen?.setAttribute("aria-expanded", "true");
        mobileMenuOverlay?.setAttribute("aria-hidden", "false");
        mobileMenuOverlay?.removeAttribute("inert");
        document.body.style.overflow = "hidden";
        mobileMenuClose?.focus();
    }

    function isMenuOpen() {
        return mobileMenuOverlay?.classList.contains("translate-y-0") ?? false;
    }

    function closeMenu(restoreFocus = true) {
        mobileMenuOverlay?.classList.remove("translate-y-0");
        mobileMenuOverlay?.classList.add("translate-y-[-100%]");
        mobileMenuOpen?.setAttribute("aria-expanded", "false");
        mobileMenuOverlay?.setAttribute("aria-hidden", "true");
        mobileMenuOverlay?.setAttribute("inert", "");
        document.body.style.overflow = "";
        if (restoreFocus) {
            mobileMenuOpen?.focus();
        }
    }

    function onEscape(event: KeyboardEvent) {
        if (event.key === "Escape" && isMenuOpen()) {
            closeMenu();
        }
    }

    mobileMenuOpen?.addEventListener("click", openMenu);
    mobileMenuClose?.addEventListener("click", () => closeMenu());
    document.addEventListener("keydown", onEscape);

    mobileNavLinks.forEach((link) => {
        link.addEventListener("click", () => closeMenu(false));
    });
</script>
